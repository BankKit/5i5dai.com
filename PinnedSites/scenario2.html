<!DOCTYPE html>
<!-- Copyright Â© Microsoft Corporation. All rights reserved. -->
<html>
<head>
    <title>Internet Explorer Developer Sample</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" type="text/css" href="css/base-sdk.css" />
    <script type="text/javascript" src="script/base-sdk.js"></script>

    <!-- Pinned Site IE11 Code -->
    <meta name="application-name" content=" Contoso" />
    <meta name="msapplication-TileColor" content=" #009900" />
    <meta name="msapplication-square70x70logo" content="images/smalltile.png" />
    <meta name="msapplication-square150x150logo" content="images/mediumtile.png" />
    <meta name="msapplication-wide310x150logo" content="images/widetile.png" />
    <meta name="msapplication-square310x310logo" content="images/largetile.png" />
    <script>
      if (document.addEventListener) {
        document.addEventListener('mssitepinned', StartPeriodicUpdateBatch, false);
      } else {
        window.onload = StartPeriodicUpdateBatch;
      }

      function StartPeriodicUpdateBatch()
      {
          var arrURI = ["notifications/contoso1.xml", "notifications/contoso2.xml", "notifications/contoso3.xml"];
          window.external.msEnableTileNotificationQueue(true);
          window.external.msStartPeriodicTileUpdateBatch(arrURI);
      }
    </script>
    <!-- End of Pinned Site IE11 Code -->
 
</head>
<body>
   <div id="header" role="contentinfo"></div>

    <!--Sample title-->
    <h1 id="sampleTitle">Live Tiles support in IE11</h1>

    <h2>Scenario 2: Using JavaScript</h2>
    <p>
        <a href="default.html">Back to scenarios menu</a>
    </p>

    <div class="descRegion" role="region" aria-labelledby="descLabel" aria-live="assertive">
      <h2 id="descLabel">Description</h2>
      <div class="descContent">

      <!--Description and code snippet-->
      <p>The following JavaScript listens for the pinning event and when the pinning action occurs, calls StartPeriodicUpdateBatch
      to turn on live tiles. The EnableNotificationQueue function turns cycling on.
      <br><br>

      To see this sample code in action, pin this page to the Windows 8.1 Start screen from IE11 (in the new Windows UI).</p>
          
      <h2 class="codeLabel">JavaScript</h2>
<pre>
  document.addEventListener('mssitepinned', StartPeriodicUpdateBatch, false);

  function StartPeriodicUpdateBatch()
  {
      var arrURI = ["notifications/contoso1.xml", "notifications/contoso2.xml", "notifications/contoso3.xml"];
      window.external.msEnableTileNotificationQueue(true);
      window.external.msStartPeriodicTileUpdateBatch(arrURI);
  }
</pre>
        <h2 class="codeLabel">Polling XMLs</h2>
        <a href="notifications/contoso1.xml"><h4>notifications/contoso1.xml</h4></a>
        <a href="notifications/contoso2.xml"><h4>notifications/contoso2.xml</h4></a>
        <a href="notifications/contoso3.xml"><h4>notifications/contoso3.xml</h4></a>
      </div>
    </div>
    <div id="footer" role="contentinfo"></div>
</body>
</html>